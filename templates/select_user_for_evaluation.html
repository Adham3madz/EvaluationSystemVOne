{% extends "layout.html" %}
{% block title %}{{ page_title }}{% endblock %}

{% block content %}
<style>
  /* ===== Ø¥Ø¹Ø¯Ø§Ø¯ Ø¹Ø§Ù… ===== */
  body {
      direction: rtl;
      font-family: "Tajawal", "Segoe UI", sans-serif;
      background-color: #f5f7fa;
      color: #222;
      margin: 0;
      padding: 0;
  }

  /* ===== Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© ===== */
  .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      background-color: #e9f0fb;
      border-radius: 10px;
      padding: 15px 20px;
      margin-bottom: 25px;
      border-right: 5px solid #004d99;
  }

  .page-header h3 {
      color: #004d99;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1.3rem;
  }

  /* --- NEW: Search Bar Styles --- */
  .search-section {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 20px;
  }
  .search-form {
      display: flex;
      gap: 15px;
  }
  .search-input {
      flex: 1;
      padding: 10px 14px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 15px;
  }
  .btn-search {
      background-color: #004d7a;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
  }
  .btn-clear {
      background-color: #6c757d;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
  }
  /* --- End Search Bar Styles --- */

  /* ===== Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¬Ø¯ÙˆÙ„ ===== */
  .table-container {
      background-color: #fff;
      border-radius: 12px;
      box-shadow: 0 3px 15px rgba(0, 0, 0, 0.08);
      overflow-x: auto;
  }

  /* ===== ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ===== */
  table {
      width: 100%;
      border-collapse: collapse;
      text-align: center;
      font-size: 0.95rem;
  }

  thead {
      background-color: #004d99;
      color: #fff;
  }

  th, td {
      padding: 10px 8px;
      border-bottom: 1px solid #dee2e6;
  }

  tbody tr:nth-child(even) {
      background-color: #f8f9fc;
  }

  tbody tr:hover {
      background-color: #eef4ff;
  }

  /* ===== Ø§Ù„Ø£Ø²Ø±Ø§Ø± ===== */
  .btn {
      border: none;
      border-radius: 8px;
      padding: 6px 12px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
      text-decoration: none;
      display: inline-block;
  }

  .btn-success {
      background-color: #007b3e;
      color: #fff;
  }

  .btn-success:hover {
      background-color: #005f2e;
  }

  /* ===== Ø§Ù„ØµÙ Ø§Ù„ÙØ§Ø±Øº ===== */
  .empty-row {
      text-align: center;
      color: #888;
      font-style: italic;
  }

  /* ===== Ø§Ù„Ù‡ÙˆØ§ØªÙ ===== */
  @media (max-width: 768px) {
      .page-header {
          flex-direction: column;
          gap: 10px;
          text-align: center;
      }
      .search-form {
          flex-direction: column;
      }
      table {
          font-size: 0.85rem;
      }
      th, td {
          padding: 8px 5px;
      }
      .btn {
          padding: 5px 10px;
          font-size: 0.8rem;
      }
  }
</style>

<div class="page-header">
  <h3>ğŸ§¾ {{ page_title }}</h3>
</div>

<div class="search-section">
    <form id="searchForm" method="GET" action="{{ url_for('select_user_for_evaluation') }}" class="search-form">
        <input type="text" 
               name="search" 
               id="search" 
               class="search-input" 
               placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØŒ Ø§Ù„Ù‚Ø³Ù…..." 
               value="{{ filters.get('search', '') }}">
        
        <button type="submit" class="btn btn-search">Ø¨Ø­Ø«</button>
        <button type="button" onclick="clearSearch()" class="btn btn-clear">Ù…Ø³Ø­</button>
    </form>
</div>
<div class="table-container">
  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…</th>
        <th>ğŸ’¼ Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ / Ø§Ù„Ø¯ÙˆØ±</th>
        <th>ğŸ¢ Ø§Ù„Ù‚Ø³Ù…</th>
        <th>âš™ï¸ Ø¥Ø¬Ø±Ø§Ø¡</th>
      </tr>
    </thead>
    <tbody>
      {% for u in users %}
      <tr>
        <td>{{ u.USERID }}</td>
        <td>{{ u.NAME }}</td>
        <td>{{ u.TITLE or u.PositionName or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</td>
        <td>{{ u.DEPTNAME or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</td>
        <td>
          {% if role_id == 2 and u.IsManager %}
            <a href="{{ url_for('new_evaluation', employee_id=u.USERID, is_manager='true') }}" class="btn btn-success">
              âœï¸ Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
            </a>
          {% elif role_id == 3 %}
            <a href="{{ url_for('new_evaluation', employee_id=u.USERID) }}" class="btn btn-success">
              âœï¸ Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
            </a>
          {% endif %}
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="5" class="empty-row">
          {% if filters.get('search') %}
            Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø¨Ø­Ø«.
          {% elif role_id == 3 %}
            Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† ÙÙŠ Ù‚Ø³Ù…Ùƒ Ù„ØªÙ‚ÙŠÙŠÙ…Ù‡Ù….
          {% elif role_id == 2 %}
            Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¯ÙŠØ±ÙŠÙ† Ù„ØªÙ‚ÙŠÙŠÙ…Ù‡Ù….
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<script>
    function clearSearch() {
        document.getElementById('search').value = '';
        document.getElementById('searchForm').submit();
    }
</script>

{% endblock %}