{% extends "layout.html" %}
{% block title %}{{ 'Ø¥Ø¶Ø§ÙØ©' if action == 'Add' else 'ØªØ¹Ø¯ÙŠÙ„' }} Ù…Ø³ØªØ®Ø¯Ù…{% endblock %}

{% block content %}
<style>
  /* === Base Styling === */
  body {
    direction: rtl;
    background-color: #f8fafc;
    font-family: "Cairo", sans-serif;
    color: #222;
  }

  /* === Container === */
  .container {
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.07);
    padding: 30px 40px;
    max-width: 650px;
    margin: 40px auto;
  }

  /* === Title === */
  h2 {
    color: #0d47a1;
    font-weight: 700;
    text-align: center;
    margin-bottom: 30px;
    border-bottom: 2px solid #f0f0f0;
    padding-bottom: 15px;
  }

  /* === Form Elements === */
  .form-group {
    margin-bottom: 20px;
  }

  label {
    font-weight: 600;
    color: #333;
    margin-bottom: 8px;
    display: block;
  }

  input[type="text"],
  input[type="password"],
  select {
    width: 100%;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 15px;
    transition: 0.3s ease;
    background-color: #fff;
  }

  input:focus,
  select:focus {
    border-color: #1976d2;
    outline: none;
    box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.1);
  }

  small.text-muted {
    color: #666;
    font-size: 0.85rem;
    margin-top: 5px;
    display: block;
  }

  /* === Buttons === */
  .actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #eee;
  }

  .btn {
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    font-size: 15px;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  .btn-primary {
    background-color: #1565c0;
    color: white;
  }

  .btn-primary:hover {
    background-color: #0d47a1;
    transform: translateY(-1px);
  }

  .btn-secondary {
    background-color: #f5f5f5;
    color: #333;
    border: 1px solid #ddd;
  }

  .btn-secondary:hover {
    background-color: #e0e0e0;
  }
</style>

<div class="container">
  <h2>{{ 'ğŸ‘¤ Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯' if action == 'Add' else 'âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…' }}</h2>

  <form method="POST">
    
    <div class="form-group">
      <label for="username">Ø§Ø³Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„ (Username):</label>
      <input type="text" id="username" name="username" required 
             value="{{ user.Username if user else '' }}" 
             placeholder="Ù…Ø«Ø§Ù„: admin">
    </div>

    <div class="form-group">
      <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
      <input type="password" id="password" name="password" 
             {% if action == 'Add' %}required{% endif %} 
             placeholder="{{ 'Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©' if action == 'Add' else 'Ø§ØªØ±ÙƒÙ‡Ø§ ÙØ§Ø±ØºØ© Ù„Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©' }}">
      {% if action == 'Edit' %}
      <small class="text-muted">âš ï¸ Ø§ØªØ±Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ ÙØ§Ø±ØºØ§Ù‹ Ø¥Ø°Ø§ ÙƒÙ†Øª Ù„Ø§ ØªØ±ÙŠØ¯ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.</small>
      {% endif %}
    </div>

    <div class="form-group">
      <label for="name">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
      <input type="text" id="name" name="name" 
             value="{{ user.Name if user else '' }}" 
             placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯">
    </div>

    <div class="form-group">
      <label for="role_id">Ø§Ù„Ø¯ÙˆØ± (Role):</label>
      <select id="role_id" name="role_id" required>
        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ± --</option>
        {% for role in roles %}
        <option value="{{ role.RoleID }}" 
          {% if user and user.RoleID == role.RoleID %}selected{% endif %}>
          {{ role.RoleName }}
        </option>
        {% endfor %}
      </select>
    </div>

    <div class="form-group">
      <label for="department_id">Ø§Ù„Ù‚Ø³Ù… Ø§Ù„ØªØ§Ø¨Ø¹ Ù„Ù‡:</label>
      <select id="department_id" name="department_id">
        <option value="">-- Ù„Ø§ ÙŠÙˆØ¬Ø¯ / Ø¹Ø§Ù… --</option>
        {% for dept in depts %}
        <option value="{{ dept.DEPTID }}" 
          {% if user and user.DepartmentID == dept.DEPTID %}selected{% endif %}>
          {{ dept.DEPTNAME }}
        </option>
        {% endfor %}
      </select>
      <small class="text-muted">Ù…Ø·Ù„ÙˆØ¨ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¯ÙˆØ± "Ù…Ø¯ÙŠØ±" (Manager) Ù„Ø±Ø¨Ø·Ù‡ Ø¨Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù….</small>
    </div>

    <div class="actions">
      <a href="{{ url_for('users') }}" class="btn btn-secondary">
        â¬…ï¸ Ø¥Ù„ØºØ§Ø¡ ÙˆØ±Ø¬ÙˆØ¹
      </a>
      <button type="submit" class="btn btn-primary">
        âœ… {{ 'Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…' if action == 'Add' else 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª' }}
      </button>
    </div>

  </form>
</div>
{% endblock %}