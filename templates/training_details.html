{% extends "layout.html" %}
{% block title %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¬Ù„Ø³Ø©{% endblock %}

{% block content %}
<div class="container-fluid">

    <div class="d-flex justify-content-between mb-4">
        <h4 class="fw-bold">ğŸ“ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©</h4>
        <a class="btn btn-primary" href="{{ url_for('training_enroll', sid=training_session.SessionID) }}">â• ØªØ³Ø¬ÙŠÙ„ Ù…ÙˆØ¸Ù</a>
    </div>

    <div class="card shadow-sm p-4 mb-4">
        <h5 class="fw-bold mb-3">â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø©</h5>

        <div class="row">
            <div class="col-md-6">
                <p><strong>Ø§Ù„Ø¯ÙˆØ±Ø©:</strong> {{ training_session.TrainingCourseText }}</p>
                <p><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> {{ training_session.SessionDate }} Ø¥Ù„Ù‰ {{ training_session.EndDate or '-' }}</p>
            </div>
            <div class="col-md-6">
                <p><strong>Ø§Ù„Ù…ÙƒØ§Ù†:</strong> {{ training_session.Location or '-' }}</p>
                {% if training_session.IsExternal %}
                    <p><strong>Ø§Ù„Ù…Ø¯Ø±Ø¨:</strong> {{ training_session.ExternalTrainerName }} (Ø®Ø§Ø±Ø¬ÙŠ)</p>
                {% else %}
                    <p><strong>Ø§Ù„Ù…Ø¯Ø±Ø¨:</strong> {{ training_session.InstructorName or '-' }}</p>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="card shadow-sm p-4">
        <h5 class="fw-bold mb-3">ğŸ‘¥ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</h5>

        {% if enrollments %}
        <table class="table table-bordered text-center align-middle">
            <thead class="table-secondary">
                <tr>
                    <th style="width: 20%;">Ø§Ù„Ù…ÙˆØ¸Ù</th>
                    <th style="width: 10%;">Ø§Ù„Ø¯Ø±Ø¬Ø©</th>
                    <th style="width: 10%;">Ø§Ù„Ù†Ø¬Ø§Ø­</th>
                    <th style="width: 10%;">Ø§Ù„Ø­Ø¶ÙˆØ± %</th>
                    <th style="width: 10%;">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø¯ÙŠØ±</th>
                    <th style="width: 25%;">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ±</th>
                    <th style="width: 15%;">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
            </thead>
            <tbody>
                {% for e in enrollments %}
                <tr>
                    <td class="fw-bold">{{ e.NAME }}</td>
                    <td>{{ e.Grade or '-' }}</td>
                    <td>
                        {% if e.PassStatus == 'Passed' %}
                            <span class="badge bg-success">Ù†Ø§Ø¬Ø­</span>
                        {% elif e.PassStatus == 'Failed' %}
                            <span class="badge bg-danger">Ø±Ø§Ø³Ø¨</span>
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td>{{ e.AttendancePercent or '-' }}%</td>
                    <td>{{ e.ManagerRating or '-' }}</td>
                    <td>{{ e.ManagerComments or '-' }}</td>
                    <td>
                        <form method="POST"
                              action="{{ url_for('training_enrollment_update', eid=e.EnrollmentID) }}">

                            <div class="mb-1">
                                <input type="number" name="grade" class="form-control form-control-sm"
                                       placeholder="Ø§Ù„Ø¯Ø±Ø¬Ø©" value="{{ e.Grade }}">
                            </div>

                            <div class="mb-1">
                                <select name="pass_status" class="form-select form-select-sm">
                                    <option value="">â€” Ø§Ù„Ø­Ø§Ù„Ø© â€”</option>
                                    <option value="Passed" {% if e.PassStatus=='Passed' %}selected{% endif %}>
                                        Ù†Ø§Ø¬Ø­
                                    </option>
                                    <option value="Failed" {% if e.PassStatus=='Failed' %}selected{% endif %}>
                                        Ø±Ø§Ø³Ø¨
                                    </option>
                                </select>
                            </div>

                            <div class="mb-1">
                                <input type="number" name="attendance" class="form-control form-control-sm"
                                       placeholder="Ø­Ø¶ÙˆØ± %" value="{{ e.AttendancePercent }}">
                            </div>

                            <div class="mb-1">
                                <input type="number" name="manager_rating" class="form-control form-control-sm"
                                       placeholder="ØªÙ‚ÙŠÙŠÙ… (1-5)" value="{{ e.ManagerRating }}">
                            </div>

                            <div class="mb-1">
                                <input type="text" name="manager_comments" class="form-control form-control-sm"
                                       placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª" value="{{ e.ManagerComments }}">
                            </div>

                            <button class="btn btn-sm btn-success w-100">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
            <div class="alert alert-info text-center">
                Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù„Ø³Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.
            </div>
        {% endif %}

    </div>
</div>
{% endblock %}