{% extends "layout.html" %}
{% block title %}Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªØ§Ø­Ø©{% endblock %}

{% block content %}
<style>
    /* === Header === */
    .job-header {
        background: linear-gradient(135deg, #004d7a, #00608f);
        color: white; padding: 35px; border-radius: 20px; text-align: center; margin-bottom: 40px;
        box-shadow: 0 10px 30px rgba(0, 77, 122, 0.2); position: relative; overflow: hidden;
    }
    .job-header h2 { font-weight: 800; margin-bottom: 10px; letter-spacing: 0.5px; }

    /* === Add Button === */
    .btn-add-floating {
        background: rgba(255,255,255,0.2); backdrop-filter: blur(5px);
        border: 1px solid rgba(255,255,255,0.4); color: white;
        padding: 10px 25px; border-radius: 50px; font-weight: bold;
        text-decoration: none; display: inline-flex; align-items: center; gap: 8px;
        margin-top: 15px; transition: 0.3s;
    }
    .btn-add-floating:hover { background: white; color: #004d7a; transform: translateY(-3px); }

    /* === Job Card === */
    .job-card {
        background: #fff; border-radius: 16px; border: 1px solid #f0f2f5;
        box-shadow: 0 5px 15px rgba(0,0,0,0.04); transition: all 0.3s ease;
        height: 100%; display: flex; flex-direction: column; position: relative; overflow: hidden;
    }
    .job-card:hover { transform: translateY(-7px); box-shadow: 0 15px 35px rgba(0,0,0,0.08); }

    /* Status Strip */
    .status-strip { height: 5px; width: 100%; }
    .strip-Active { background: #2ecc71; }
    .strip-Paused { background: #f1c40f; }
    .strip-Closed { background: #e74c3c; }

    /* Card Body */
    .card-body { padding: 25px; flex: 1; }

    /* Badges */
    .badge-status {
        position: absolute; top: 20px; left: 20px;
        padding: 5px 12px; border-radius: 30px; font-size: 11px; font-weight: 800; text-transform: uppercase;
    }
    .badge-Active { background: #e8f8f5; color: #27ae60; }
    .badge-Paused { background: #fef9e7; color: #f1c40f; }
    .badge-Closed { background: #fdedec; color: #c0392b; }

    .job-title { font-size: 18px; font-weight: 800; color: #2c3e50; margin-bottom: 5px; margin-top: 10px; }
    .dept-name { color: #004d7a; font-size: 13px; font-weight: 600; display: block; margin-bottom: 15px; }
    
    /* Details Grid */
    .details-grid {
        display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;
        font-size: 13px; color: #555; background: #f8f9fa; padding: 10px; border-radius: 8px;
    }
    .detail-item i { color: #95a5a6; width: 20px; }

    .job-desc { font-size: 13px; color: #777; margin-bottom: 20px; line-height: 1.5; 
                display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

    /* Footer Actions */
    .card-footer {
        padding: 15px 25px; border-top: 1px solid #f1f2f5; background: #fff;
        display: flex; justify-content: space-between; align-items: center;
    }

    .applicant-count {
        font-size: 13px; font-weight: 700; color: #555; display: flex; align-items: center; gap: 5px;
    }
    .count-badge { background: #e3f2fd; color: #004d7a; padding: 2px 8px; border-radius: 10px; }

    .action-group { display: flex; gap: 8px; }
    .btn-icon {
        width: 32px; height: 32px; border-radius: 8px; border: none;
        display: inline-flex; align-items: center; justify-content: center;
        transition: 0.2s; cursor: pointer; font-size: 14px; text-decoration: none;
    }
    .btn-view { background: #004d7a; color: white; width: auto; padding: 0 15px; font-weight: bold; font-size: 12px; }
    .btn-view:hover { background: #003a5c; color: white; }
    
    .btn-edit { background: #fff4e5; color: #f39c12; }
    .btn-edit:hover { background: #f39c12; color: white; }
    
    .btn-delete { background: #ffecec; color: #e74c3c; }
    .btn-delete:hover { background: #e74c3c; color: white; }
</style>

<div class="job-header">
    <h2>ğŸ“¢ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø´Ø§ØºØ±Ø© (Job Listings)</h2>
    <p>Ø¥Ø¯Ø§Ø±Ø© Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„ÙˆØ¸Ø§Ø¦Ù ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙŠÙ†</p>
    <a href="{{ url_for('job_add') }}" class="btn-add-floating">
        <i class="fa-solid fa-plus"></i> Ù†Ø´Ø± ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø©
    </a>
</div>

<div class="row g-4">
    {% for job in jobs %}
    <div class="col-md-6 col-lg-4">
        <div class="job-card">
            <div class="status-strip strip-{{ job.Status }}"></div>
            
            <div class="card-body">
                <span class="badge-status badge-{{ job.Status }}">{{ job.Status }}</span>
                
                <div class="job-title">{{ job.JobTitle }}</div>
                <span class="dept-name"><i class="fa-solid fa-building"></i> {{ job.DEPTNAME }}</span>

                <div class="details-grid">
                    <div class="detail-item">
                        <i class="fa-solid fa-money-bill-wave"></i> {{ job.SalaryRange or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}
                    </div>
                    <div class="detail-item">
                        <i class="fa-regular fa-clock"></i> {{ job.Deadline.strftime('%Y-%m-%d') if job.Deadline else 'Ù…ÙØªÙˆØ­' }}
                    </div>
                    <div class="detail-item" style="grid-column: span 2;">
                        <i class="fa-regular fa-calendar-check"></i> Ù†ÙØ´Ø±: {{ job.PostDate.strftime('%Y-%m-%d') }}
                    </div>
                </div>

                <div class="job-desc">
                    {{ job.Description or 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù…ØªØ§Ø­...' }}
                </div>
            </div>
            
            <div class="card-footer">
                <div class="applicant-count">
                    <i class="fa-solid fa-users"></i> Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙŠÙ† <span class="count-badge">{{ job.ApplicantCount }}</span>
                </div>
                
                <div class="action-group">
                    <a href="{{ url_for('recruitment_list', job_id=job.JobID) }}" class="btn-icon btn-view" title="Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙŠÙ†">
                        <i class="fa-solid fa-eye"></i> Ø¹Ø±Ø¶
                    </a>
                    
                    <a href="{{ url_for('job_edit', jid=job.JobID) }}" class="btn-icon btn-edit" title="ØªØ¹Ø¯ÙŠÙ„">
                        <i class="fa-solid fa-pen"></i>
                    </a>

                    <form action="{{ url_for('job_delete', jid=job.JobID) }}" method="POST" style="margin:0;" onsubmit="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„ÙˆØ¸ÙŠÙØ©ØŸ');">
                        <button type="submit" class="btn-icon btn-delete" title="Ø­Ø°Ù">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    {% else %}
    <div class="col-12 text-center py-5">
        <i class="fa-solid fa-briefcase fa-3x text-muted mb-3" style="opacity: 0.3;"></i>
        <h4 class="text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ¸Ø§Ø¦Ù Ù…Ù†Ø´ÙˆØ±Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</h4>
        <p class="text-muted">Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø© Ù„ÙØªØ­ Ø¨Ø§Ø¨ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ….</p>
    </div>
    {% endfor %}
</div>
{% endblock %}