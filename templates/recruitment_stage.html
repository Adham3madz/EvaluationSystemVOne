{% extends "layout.html" %}
{% block title %}{{ page_info.title }} {% if page_info.title == 'Ù…Ø±Ø­Ù„Ø© Ø§Ù„ÙØ±Ø² (New)' %}ğŸ†•{% elif page_info.title == 'Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (HR)' %}ğŸ‘¥{% elif page_info.title == 'Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (Technical)' %}ğŸ§‘â€ğŸ’»{% elif page_info.title == 'Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹Ù…Ù„ (Offer)' %}ğŸ“„{% elif page_info.title == 'Ø§Ù„Ù…Ø±ÙÙˆØ¶ÙŠÙ† (Rejected)' %}âŒ{% endif %}{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h4 class="fw-bold">{{ page_info.title }}</h4>
        <span class="badge bg-secondary fs-5">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ†: {{ candidates|length }}</span>
    </div>

    <!-- ÙÙ„Ø§ØªØ± -->
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <form method="GET" class="row g-3 align-items-end">
                <div class="col-md-4">
                    <label class="form-label">ğŸ” Ø¨Ø­Ø«</label>
                    <input type="text" name="search" class="form-control" placeholder="Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù‡Ø§ØªÙ Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯" value="{{ filters.search or '' }}">
                </div>
                <div class="col-md-2">
                    <label class="form-label">ğŸ¢ Ø§Ù„Ù‚Ø³Ù…</label>
                    <select name="dept_id" class="form-select">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>
                        {% for d in depts %}
                            <option value="{{ d.DEPTID }}" {% if filters.dept_id == d.DEPTID|string %}selected{% endif %}>{{ d.DEPTNAME }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">ğŸ’¼ Ø§Ù„ÙˆØ¸ÙŠÙØ©</label>
                    <select name="pos_id" class="form-select">
                        <option value="">ÙƒÙ„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</option>
                        {% for p in positions %}
                            <option value="{{ p.PositionID }}" {% if filters.pos_id == p.PositionID|string %}selected{% endif %}>{{ p.PositionName }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">ğŸ“… Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" name="date_from" class="form-control" value="{{ filters.date_from or '' }}">
                </div>
                <div class="col-md-2">
                    <label class="form-label">ğŸ“… Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" name="date_to" class="form-control" value="{{ filters.date_to or '' }}">
                </div>
                <div class="col-12 text-end">
                    <button type="submit" class="btn btn-primary">ğŸ” ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±</button>
                    <a href="{{ url_for('recruitment_stage', status_name=status_filter) }}" class="btn btn-outline-secondary">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ† -->
    <div class="card shadow-sm">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>Ø§Ù„Ø§Ø³Ù… ğŸ“›</th>
                            <th>Ø§Ù„Ù‡Ø§ØªÙ ğŸ“</th>
                            <th>Ø§Ù„Ø¨Ø±ÙŠØ¯ ğŸ“§</th>
                            <th>Ø§Ù„Ù‚Ø³Ù… ğŸ¢</th>
                            <th>Ø§Ù„ÙˆØ¸ÙŠÙØ© ğŸ’¼</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… ğŸ“…</th>
                            <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ğŸ› ï¸</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if candidates %}
                            {% for c in candidates %}
                            <tr>
                                <td><strong>{{ c.FullName }}</strong></td>
                                <td>{{ c.Phone }}</td>
                                <td>{{ c.Email or 'â€”' }}</td>
                                <td>{{ c.DEPTNAME or 'â€”' }}</td>
                                <td>{{ c.PositionName or 'â€”' }}</td>
                                <td>{{ c.ApplicationDate|format_date }}</td>
                                <td>
                                    <a href="{{ url_for('recruitment_edit', cid=c.CandidateID) }}" class="btn btn-sm btn-warning">âœï¸ ØªØ¹Ø¯ÙŠÙ„</a>
                                    {% if is_admin() %}
                                    <form action="{{ url_for('recruitment_delete', cid=c.CandidateID) }}" method="POST" style="display:inline;" onsubmit="return confirm('ğŸ—‘ï¸ Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø±Ø´Ø­ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ØŸ');">
                                        <button type="submit" class="btn btn-sm btn-danger">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                                    </form>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        {% else %}
                            <tr>
                                <td colspan="7" class="text-center py-5 text-muted">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø±Ø´Ø­ÙŠÙ† ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§ ğŸ˜”</td>
                            </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="mt-4 text-center">
        <a href="{{ url_for('recruitment_list') }}" class="btn btn-outline-primary">ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</a>
    </div>
</div>
{% endblock %}